!function(t){var i,o;if("function"==typeof define&&define.amd)define(["leaflet","proj4"],t);else if("undefined"!=typeof module)i=require("leaflet"),o=require("proj4"),module.exports=t(i,o);else{if("undefined"==typeof window.L||"undefined"==typeof window.proj4)throw"Leaflet and proj4 must be loaded first";t(window.L,window.proj4)}}(function(t,i){return t.Proj={},t.Proj._isProj4Obj=function(t){return"undefined"!=typeof t.inverse&&"undefined"!=typeof t.forward},t.Proj.ScaleDependantTransformation=function(t){this.scaleTransforms=t},t.Proj.ScaleDependantTransformation.prototype.transform=function(t,i){return this.scaleTransforms[i].transform(t,i)},t.Proj.ScaleDependantTransformation.prototype.untransform=function(t,i){return this.scaleTransforms[i].untransform(t,i)},t.Proj.Projection=t.Class.extend({initialize:function(o,s){if(t.Proj._isProj4Obj(o))this._proj=o;else{var e=o;if(s)i.defs(e,s);else if(void 0===i.defs[e]){var n=e.split(":");if(n.length>3&&(e=n[n.length-3]+":"+n[n.length-1]),void 0===i.defs[e])throw"No projection definition for code "+e}this._proj=i(e)}},project:function(i){var o=this._proj.forward([i.lng,i.lat]);return new t.Point(o[0],o[1])},unproject:function(i,o){var s=this._proj.inverse([i.x,i.y]);return new t.LatLng(s[1],s[0],o)}}),t.Proj.CRS=t.Class.extend({includes:t.CRS,options:{transformation:new t.Transformation(1,0,-1,0)},initialize:function(i,o,s){var e,n,r,a;if(t.Proj._isProj4Obj(i)?(n=i,e=n.srsCode,a=o||{},this.projection=new t.Proj.Projection(n)):(e=i,r=o,a=s||{},this.projection=new t.Proj.Projection(e,r)),t.Util.setOptions(this,a),this.code=e,this.transformation=this.options.transformation,this.options.origin&&(this.transformation=new t.Transformation(1,-this.options.origin[0],-1,this.options.origin[1])),this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(var h=this.options.resolutions.length-1;h>=0;h--)this.options.resolutions[h]&&(this._scales[h]=1/this.options.resolutions[h])}},scale:function(t){var i,o,s,e,n=Math.floor(t);return t===n?this._scales[t]:(i=this._scales[n],o=this._scales[n+1],s=o-i,e=t-n,i+s*e)},getSize:function(i){var o,s,e,n=this.options.bounds;return n?(o=this.scale(i),s=this.transformation.transform(n.min,o),e=this.transformation.transform(n.max,o),t.point(Math.abs(e.x-s.x),Math.abs(e.y-s.y))):(o=256*Math.pow(2,i),t.point(o,o))}}),t.Proj.CRS.TDT=t.Proj.CRS.extend({inch2centimeter:.0254,dpi:96,earth:6378137,initialize:function(i,o,s){var e,n,r,a;if(t.Proj._isProj4Obj(i)?(n=i,e=n.srsCode,a=o||{},this.projection=new t.Proj.Projection(n)):(e=i,r=o,a=s||{},this.projection=new t.Proj.Projection(e,r)),t.Util.setOptions(this,a),this.code=e,this.transformation=this.options.transformation,this.options.origin&&(this.transformation=new t.Transformation(1,-this.options.origin[0],-1,this.options.origin[1])),this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(var h=this.options.resolutions.length-1;h>=0;h--)this.options.resolutions[h]&&(this._scales[h]=1/this.options.resolutions[h])}else this._scales=[295829355.45,147914677.73,73957338.86,36978669.43,18489334.72,9244667.36,4622333.68,2311166.84,1155583.42,577791.71,288895.85,144447.93,72223.96,36111.98,18055.99,9028,4514,2257,1128.5,564.25]},latLngToPoint:function(i,o){var s=i.lng,e=i.lat,n=o;return s+=180,e=90-e,x=s/360*256*Math.pow(2,n),y=e/360*256*Math.pow(2,n),new t.Point(x,y)},pointToLatLng:function(i,o){var s=i.x,e=i.y,n=o,r=e/Math.pow(2,n)/256*360,r=Math.abs(90-r),a=s/Math.pow(2,n)/256*360,a=a-180;return new t.LatLng(r,a)}}),t.Proj}),L.TileLayer.TDTWMTS=L.TileLayer.extend({des:"this is a layer for tdt wmts with cgsc2000",scales:[295829355.45,147914677.73,73957338.86,36978669.43,18489334.72,9244667.36,4622333.68,2311166.84,1155583.42,577791.71,288895.85,144447.93,72223.96,36111.98,18055.99,9028,4514,2257,1128.5,564.25],resolutions:[.7031249999891485,.35156249999999994,.17578124999999997,.08789062500000014,.04394531250000007,.021972656250000007,.01098632812500002,.00549316406250001,.0027465820312500017,.0013732910156250009,.000686645507812499,.0003433227539062495,.00017166137695312503,8583068847656251e-20,42915344238281406e-21,21457672119140645e-21,10728836059570307e-21,5364418029785169e-21,2682210361715995e-21,13411051808579975e-22],defaultWmtsParams:{service:"WMTS",request:"GetTile",version:"1.0.0",layer:"",style:"",tilematrixSet:"",format:"image/jpeg"},initialize:function(t,i,o){this._url=t,this.sub=o||!1;var s=L.extend({},this.defaultWmtsParams),e=i.tileSize||this.options.tileSize;i.detectRetina&&L.Browser.retina?s.width=s.height=2*e:s.width=s.height=e;for(var n in i)this.options.hasOwnProperty(n)||"matrixIds"==n||(s[n]=i[n]);this.wmtsParams=s,this.matrixIds=i.matrixIds||this.getDefaultMatrix(),L.setOptions(this,i)},onAdd:function(t){L.TileLayer.prototype.onAdd.call(this,t)},pixel2LonLat:function(t,i){var o=t.y,s=t.x,e=o/Math.pow(2,i)/256*360;e=Math.abs(90-e);var n=s/Math.pow(2,i)/256*360;return n-=180,new L.LatLng(e,n)},getTileUrl:function(t,i){var o=this._map;return i=o.getZoom(),this.matrixIds[i]?(ident=this.matrixIds[i].identifier,url=L.Util.template(this._url,{s:this._getSubdomain(t)}),url+L.Util.getParamString(this.wmtsParams,url)+"&tilematrix="+ident+"&tilerow="+t.y+"&tilecol="+t.x):""},setParams:function(t,i){return L.extend(this.wmtsParams,t),i||this.redraw(),this},getDefaultMatrix:function(){for(var t=[],i=this.sub?14:7,o=(this.sub,20),s=i;o>=s;s++)t[s]={identifier:""+s,scale:this.scales[s],resolution:this.resolutions[s],topLeftCorner:new L.LatLng(-180,90)};return t}}),L.tileLayer.tdtwmts=function(t,i){return new L.TileLayer.TDTWMTS(t,i)};